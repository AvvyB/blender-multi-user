version: '3.8'

services:
  blender-collab-server:
    build: .
    container_name: blender-multiuser-server
    ports:
      - "5555:5555"  # Command channel
      - "5556:5556"  # Data channel
      - "5557:5557"  # TTL/Heartbeat channel
    environment:
      - PORT=5555
      - ADMIN_PASSWORD=${ADMIN_PASSWORD:-admin}
      - SERVER_PASSWORD=${SERVER_PASSWORD:-}
      - LOG_LEVEL=${LOG_LEVEL:-INFO}
      - TIMEOUT=${TIMEOUT:-10000}
      - DATA_DIR=/app/data
      - SAVE_INTERVAL=${SAVE_INTERVAL:-120}
      - MAX_BACKUPS=${MAX_BACKUPS:-10}
    restart: unless-stopped
    volumes:
      - ./logs:/app/logs
      - ./data:/app/data  # Persistent session storage
    networks:
      - blender-network

networks:
  blender-network:
    driver: bridge
